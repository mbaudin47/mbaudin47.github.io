<!DOCTYPE html>

<html lang="python" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Experiment with Gill, Murray, Saunders and Wright method &#8212; numericalderivative 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=8cfa8c60"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/Icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Benchmark Gill, Murray, Saunders and Wright method" href="plot_gill_murray_saunders_wright_benchmark.html" />
    <link rel="prev" title="Benchmark Dumontet &amp; Vignes method" href="plot_dumontet_vignes_benchmark.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-example-plot-gill-murray-saunders-wright-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="experiment-with-gill-murray-saunders-and-wright-method">
<span id="sphx-glr-auto-example-plot-gill-murray-saunders-wright-py"></span><h1>Experiment with Gill, Murray, Saunders and Wright method<a class="headerlink" href="#experiment-with-gill-murray-saunders-and-wright-method" title="Link to this heading">¶</a></h1>
<p>Find a step which is near to optimal for a centered finite difference
formula.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Gill, P. E., Murray, W., Saunders, M. A., &amp; Wright, M. H. (1983). Computing forward-difference intervals for numerical optimization. SIAM Journal on Scientific and Statistical Computing, 4(2), 310-321.</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">numericalderivative</span> <span class="k">as</span> <span class="nn">nd</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_first_derivative_GMSW</span><span class="p">(</span>
    <span class="n">f</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">f_prime</span><span class="p">,</span>
    <span class="n">kmin</span><span class="p">,</span>
    <span class="n">kmax</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the approximate derivative from finite differences</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : function</span>
<span class="sd">        The function.</span>
<span class="sd">    x : float</span>
<span class="sd">        The point where the derivative is to be evaluated</span>
<span class="sd">    f_prime : function</span>
<span class="sd">        The exact first derivative of the function.</span>
<span class="sd">    kmin : float, &gt; 0</span>
<span class="sd">        The minimum step k for the second derivative.</span>
<span class="sd">    kmax : float, &gt; kmin</span>
<span class="sd">        The maximum step k for the second derivative.</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        Set to True to print intermediate messages. The default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    relative_error : float, &gt; 0</span>
<span class="sd">        The relative error between the approximate first derivative</span>
<span class="sd">        and the true first derivative.</span>

<span class="sd">    feval : int</span>
<span class="sd">        The number of function evaluations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">algorithm</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GillMurraySaundersWright</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
    <span class="n">step</span><span class="p">,</span> <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span><span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>
    <span class="n">f_prime_approx</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">compute_first_derivative</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">feval</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">get_number_of_function_evaluations</span><span class="p">()</span>
    <span class="n">f_prime_exact</span> <span class="o">=</span> <span class="n">f_prime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Computed step = </span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of iterations = </span><span class="si">{</span><span class="n">number_of_iterations</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f_prime_approx = </span><span class="si">{</span><span class="n">f_prime_approx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;f_prime_exact = </span><span class="si">{</span><span class="n">f_prime_exact</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">absolute_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_prime_approx</span> <span class="o">-</span> <span class="n">f_prime_exact</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">absolute_error</span><span class="p">,</span> <span class="n">feval</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+ Test on ExponentialDerivativeBenchmark&quot;</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-15</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e1</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">ExponentialProblem</span><span class="p">()</span>
<span class="n">second_derivative_value</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">second_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">optimal_step</span><span class="p">,</span> <span class="n">absolute_error</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">FirstDerivativeForward</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span>
    <span class="n">second_derivative_value</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact h* = </span><span class="si">%.3e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">optimal_step</span><span class="p">))</span>
<span class="p">(</span>
    <span class="n">absolute_error</span><span class="p">,</span>
    <span class="n">number_of_function_evaluations</span><span class="p">,</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">compute_first_derivative_GMSW</span><span class="p">(</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">function</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">first_derivative</span><span class="p">,</span>
    <span class="n">kmin</span><span class="p">,</span>
    <span class="n">kmax</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;x = </span><span class="si">%.3f</span><span class="s2">, error = </span><span class="si">%.3e</span><span class="s2">, Func. eval. = </span><span class="si">%d</span><span class="s2">&quot;</span>
    <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">absolute_error</span><span class="p">,</span> <span class="n">number_of_function_evaluations</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>+ Test on ExponentialDerivativeBenchmark
Exact h* = 1.213e-08
kmin = 1.000e-15, c(kmin) = 2.448e+00
kmax = 1.000e+01, c(kmax) = 1.816e-20
Iter #0, kmin = 1.000e-15, kmax = 1.000e+01, k = 1.000e-07, c(k) = 3.886e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.987e-08
Number of iterations = 0
f_prime_approx = 2.718281868919099
f_prime_exact = 2.718281828459045
x = 1.000, error = 4.046e-08, Func. eval. = 12
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+ Test on ScaledExponentialDerivativeBenchmark&quot;</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-9</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e8</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">ScaledExponentialProblem</span><span class="p">()</span>
<span class="n">second_derivative_value</span> <span class="o">=</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">second_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">optimal_step</span><span class="p">,</span> <span class="n">absolute_error</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">FirstDerivativeForward</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span>
    <span class="n">second_derivative_value</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact h* = </span><span class="si">%.3e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">optimal_step</span><span class="p">))</span>
<span class="p">(</span>
    <span class="n">absolute_error</span><span class="p">,</span>
    <span class="n">number_of_function_evaluations</span><span class="p">,</span>
<span class="p">)</span> <span class="o">=</span> <span class="n">compute_first_derivative_GMSW</span><span class="p">(</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">function</span><span class="p">,</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">first_derivative</span><span class="p">,</span>
    <span class="n">kmin</span><span class="p">,</span>
    <span class="n">kmax</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;x = </span><span class="si">%.3f</span><span class="s2">, error = </span><span class="si">%.3e</span><span class="s2">, Func. eval. = </span><span class="si">%d</span><span class="s2">&quot;</span>
    <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">absolute_error</span><span class="p">,</span> <span class="n">number_of_function_evaluations</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>+ Test on ScaledExponentialDerivativeBenchmark
Exact h* = 2.000e-02
kmin = 1.000e-09, c(kmin) = inf
kmax = 1.000e+08, c(kmax) = 1.488e-59
Iter #0, kmin = 1.000e-09, kmax = 1.000e+08, k = 3.162e-01, c(k) = 4.003e-03
  c in [0.001, 0.1]: stop!
Computed step = 2.001e-02
Number of iterations = 0
f_prime_approx = -9.999989916566017e-07
f_prime_exact = -9.999990000004999e-07
x = 1.000, error = 8.344e-15, Func. eval. = 12
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">benchmark_method</span><span class="p">(</span>
    <span class="n">function</span><span class="p">,</span> <span class="n">derivative_function</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply Gill, Murray, Saunders &amp; Wright method to compute the approximate first</span>
<span class="sd">    derivative using finite difference formula.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    f : function</span>
<span class="sd">        The function.</span>
<span class="sd">    derivative_function : function</span>
<span class="sd">        The exact first derivative of the function</span>
<span class="sd">    test_points : list(float)</span>
<span class="sd">        The list of x points where the benchmark must be performed.</span>
<span class="sd">    kmin : float, &gt; 0</span>
<span class="sd">        The minimum step k for the second derivative.</span>
<span class="sd">    kmax : float, &gt; kmin</span>
<span class="sd">        The maximum step k for the second derivative.</span>
<span class="sd">    verbose : bool, optional</span>
<span class="sd">        Set to True to print intermediate messages. The default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    absolute_error : float, &gt; 0</span>
<span class="sd">        The absolute error between the approximate first derivative</span>
<span class="sd">        and the true first derivative.</span>

<span class="sd">    feval : int</span>
<span class="sd">        The number of function evaluations.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">number_of_test_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_points</span><span class="p">)</span>
    <span class="n">relative_error_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_test_points</span><span class="p">)</span>
    <span class="n">feval_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">number_of_test_points</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_test_points</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">test_points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="p">(</span>
            <span class="n">absolute_error</span><span class="p">,</span>
            <span class="n">number_of_function_evaluations</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">compute_first_derivative_GMSW</span><span class="p">(</span>
            <span class="n">function</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">derivative_function</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">verbose</span>
        <span class="p">)</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="n">absolute_error</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">derivative_function</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;x = </span><span class="si">%.3f</span><span class="s2">, abs. error = </span><span class="si">%.3e</span><span class="s2">, rel. error = </span><span class="si">%.3e</span><span class="s2">, Func. eval. = </span><span class="si">%d</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">absolute_error</span><span class="p">,</span> <span class="n">relative_error</span><span class="p">,</span> <span class="n">number_of_function_evaluations</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">relative_error_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">relative_error</span>
        <span class="n">feval_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">number_of_function_evaluations</span>

    <span class="n">average_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">relative_error_array</span><span class="p">)</span>
    <span class="n">average_feval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">feval_array</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average error =&quot;</span><span class="p">,</span> <span class="n">average_error</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Average number of function evaluations =&quot;</span><span class="p">,</span> <span class="n">average_feval</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">average_error</span><span class="p">,</span> <span class="n">average_feval</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;+ Benchmark on several points&quot;</span><span class="p">)</span>
<span class="n">number_of_test_points</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">12.2</span><span class="p">,</span> <span class="n">number_of_test_points</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-13</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">ExponentialProblem</span><span class="p">()</span>
<span class="n">average_error</span><span class="p">,</span> <span class="n">average_feval</span> <span class="o">=</span> <span class="n">benchmark_method</span><span class="p">(</span>
    <span class="n">benchmark</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">benchmark</span><span class="o">.</span><span class="n">first_derivative</span><span class="p">,</span> <span class="n">test_points</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="kc">True</span>
<span class="p">)</span>


<span class="c1"># For each function, at point x = 1, plot the error vs the step computed</span>
<span class="c1"># by the method</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>+ Benchmark on several points
kmin = 1.000e-13, c(kmin) = 1.820e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.871e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.968e-08
Number of iterations = 0
f_prime_approx = 1.0100501810828826
f_prime_exact = 1.010050167084168
x = 0.010, abs. error = 1.400e-08, rel. error = 1.386e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.058e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.958e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.989e-08
Number of iterations = 0
f_prime_approx = 1.1424000200639288
f_prime_exact = 1.142400000603336
x = 0.133, abs. error = 1.946e-08, rel. error = 1.703e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.013e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.003e-08
Number of iterations = 0
f_prime_approx = 1.2920920295211449
f_prime_exact = 1.2920920206825224
x = 0.256, abs. error = 8.839e-09, rel. error = 6.841e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.989e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 1.4613986373179624
f_prime_exact = 1.4613986248509536
x = 0.379, abs. error = 1.247e-08, rel. error = 8.531e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.978e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.024e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 1.6528899855568633
f_prime_exact = 1.6528899695457635
x = 0.503, abs. error = 1.601e-08, rel. error = 9.687e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.368e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.009e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.002e-08
Number of iterations = 0
f_prime_approx = 1.8694730111853781
f_prime_exact = 1.8694729863343296
x = 0.626, abs. error = 2.485e-08, rel. error = 1.329e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 1.905e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.887e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.971e-08
Number of iterations = 0
f_prime_approx = 2.1144355445279284
f_prime_exact = 2.114435510546567
x = 0.749, abs. error = 3.398e-08, rel. error = 1.607e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.989e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 2.3914962151951604
f_prime_exact = 2.391496192211239
x = 0.872, abs. error = 2.298e-08, rel. error = 9.611e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.436e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.061e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.015e-08
Number of iterations = 0
f_prime_approx = 2.7048609636533225
f_prime_exact = 2.7048609469685205
x = 0.995, abs. error = 1.668e-08, rel. error = 6.168e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.756e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.937e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.984e-08
Number of iterations = 0
f_prime_approx = 3.0592868453041766
f_prime_exact = 3.0592868039110805
x = 1.118, abs. error = 4.139e-08, rel. error = 1.353e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.117e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.996e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.999e-08
Number of iterations = 0
f_prime_approx = 3.460154146040208
f_prime_exact = 3.4601541195948955
x = 1.241, abs. error = 2.645e-08, rel. error = 7.643e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.525e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.961e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.990e-08
Number of iterations = 0
f_prime_approx = 3.9135483015246932
f_prime_exact = 3.9135482544635316
x = 1.364, abs. error = 4.706e-08, rel. error = 1.203e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.987e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 4.426352010711396
f_prime_exact = 4.426351951573674
x = 1.488, abs. error = 5.914e-08, rel. error = 1.336e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.026e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.007e-08
Number of iterations = 0
f_prime_approx = 5.006349859809935
f_prime_exact = 5.006349819975791
x = 1.611, abs. error = 3.983e-08, rel. error = 7.957e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.985e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.996e-08
Number of iterations = 0
f_prime_approx = 5.662346601228033
f_prime_exact = 5.662346508858373
x = 1.734, abs. error = 9.237e-08, rel. error = 1.631e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.884e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.006e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.001e-08
Number of iterations = 0
f_prime_approx = 6.404300441547147
f_prime_exact = 6.404300366396617
x = 1.857, abs. error = 7.515e-08, rel. error = 1.173e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.027e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.007e-08
Number of iterations = 0
f_prime_approx = 7.243474683784711
f_prime_exact = 7.243474612311778
x = 1.980, abs. error = 7.147e-08, rel. error = 9.867e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.925e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.981e-08
Number of iterations = 0
f_prime_approx = 8.192608408113523
f_prime_exact = 8.192608319013985
x = 2.103, abs. error = 8.910e-08, rel. error = 1.088e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.013e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.003e-08
Number of iterations = 0
f_prime_approx = 9.266109926871508
f_prime_exact = 9.266109796905328
x = 2.226, abs. error = 1.300e-07, rel. error = 1.403e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.360e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.000e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.000e-08
Number of iterations = 0
f_prime_approx = 10.480275405834268
f_prime_exact = 10.480275319525907
x = 2.349, abs. error = 8.631e-08, rel. error = 8.235e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.669e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.044e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.011e-08
Number of iterations = 0
f_prime_approx = 11.853536632216311
f_prime_exact = 11.853536508896825
x = 2.473, abs. error = 1.233e-07, rel. error = 1.040e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.019e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.025e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 13.406740266437598
f_prime_exact = 13.406740136489656
x = 2.596, abs. error = 1.299e-07, rel. error = 9.693e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.970e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.993e-08
Number of iterations = 0
f_prime_approx = 15.163464803320773
f_prime_exact = 15.16346458733695
x = 2.719, abs. error = 2.160e-07, rel. error = 1.424e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.023e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 17.150377939563146
f_prime_exact = 17.15037779136259
x = 2.842, abs. error = 1.482e-07, rel. error = 8.641e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.184e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.044e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.011e-08
Number of iterations = 0
f_prime_approx = 19.397642162078153
f_prime_exact = 19.397642055503372
x = 2.965, abs. error = 1.066e-07, rel. error = 5.494e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.921e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.980e-08
Number of iterations = 0
f_prime_approx = 21.93937229221645
f_prime_exact = 21.93937194216983
x = 3.088, abs. error = 3.500e-07, rel. error = 1.596e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.049e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.012e-08
Number of iterations = 0
f_prime_approx = 24.814152374278944
f_prime_exact = 24.814152144863783
x = 3.211, abs. error = 2.294e-07, rel. error = 9.245e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.160e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.051e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.013e-08
Number of iterations = 0
f_prime_approx = 28.06562347408147
f_prime_exact = 28.06562322255567
x = 3.335, abs. error = 2.515e-07, rel. error = 8.962e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.574e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.971e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.993e-08
Number of iterations = 0
f_prime_approx = 31.74314448063908
f_prime_exact = 31.743144084554007
x = 3.458, abs. error = 3.961e-07, rel. error = 1.248e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.042e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.011e-08
Number of iterations = 0
f_prime_approx = 35.90254143544877
f_prime_exact = 35.9025412827088
x = 3.581, abs. error = 1.527e-07, rel. error = 4.254e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.010e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.003e-08
Number of iterations = 0
f_prime_approx = 40.60695674171964
f_prime_exact = 40.60695648556833
x = 3.704, abs. error = 2.562e-07, rel. error = 6.308e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.040e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.010e-08
Number of iterations = 0
f_prime_approx = 45.92780549799281
f_prime_exact = 45.927804999558255
x = 3.827, abs. error = 4.984e-07, rel. error = 1.085e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.924e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.952e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.988e-08
Number of iterations = 0
f_prime_approx = 51.94586047457165
f_prime_exact = 51.945859888000065
x = 3.950, abs. error = 5.866e-07, rel. error = 1.129e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.307e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.034e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 58.752478551635434
f_prime_exact = 58.75247814542167
x = 4.073, abs. error = 4.062e-07, rel. error = 6.914e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.980e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.995e-08
Number of iterations = 0
f_prime_approx = 66.45098854412032
f_prime_exact = 66.45098754108133
x = 4.196, abs. error = 1.003e-06, rel. error = 1.509e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.992e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.998e-08
Number of iterations = 0
f_prime_approx = 75.15825607481688
f_prime_exact = 75.15825518466322
x = 4.320, abs. error = 8.902e-07, rel. error = 1.184e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.393e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.988e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 85.00646260403484
f_prime_exact = 85.00646162573238
x = 4.443, abs. error = 9.783e-07, rel. error = 1.151e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.980e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.995e-08
Number of iterations = 0
f_prime_approx = 96.14510850057962
f_prime_exact = 96.14510741864154
x = 4.566, abs. error = 1.082e-06, rel. error = 1.125e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.975e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.994e-08
Number of iterations = 0
f_prime_approx = 108.7432835449887
f_prime_exact = 108.74328261351711
x = 4.689, abs. error = 9.315e-07, rel. error = 8.566e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.462e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.979e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.995e-08
Number of iterations = 0
f_prime_approx = 122.99223466801642
f_prime_exact = 122.99223362530132
x = 4.812, abs. error = 1.043e-06, rel. error = 8.478e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.079e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.020e-08
Number of iterations = 0
f_prime_approx = 139.1082680147748
f_prime_exact = 139.10826644716695
x = 4.935, abs. error = 1.568e-06, rel. error = 1.127e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.214e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.101e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.025e-08
Number of iterations = 0
f_prime_approx = 157.33603142549865
f_prime_exact = 157.33603028049382
x = 5.058, abs. error = 1.145e-06, rel. error = 7.277e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.504e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.039e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.010e-08
Number of iterations = 0
f_prime_approx = 177.9522322708943
f_prime_exact = 177.95223142850568
x = 5.182, abs. error = 8.424e-07, rel. error = 4.734e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.833e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.047e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.012e-08
Number of iterations = 0
f_prime_approx = 201.2698356071119
f_prime_exact = 201.26983383227272
x = 5.305, abs. error = 1.775e-06, rel. error = 8.818e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.005e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.001e-08
Number of iterations = 0
f_prime_approx = 227.642812420985
f_prime_exact = 227.64281001525893
x = 5.428, abs. error = 2.406e-06, rel. error = 1.057e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 1.812e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.939e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.985e-08
Number of iterations = 0
f_prime_approx = 257.47151855807874
f_prime_exact = 257.47151455805454
x = 5.551, abs. error = 4.000e-06, rel. error = 1.554e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.941e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.985e-08
Number of iterations = 0
f_prime_approx = 291.20876588219744
f_prime_exact = 291.20876167525324
x = 5.674, abs. error = 4.207e-06, rel. error = 1.445e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.318e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.928e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.982e-08
Number of iterations = 0
f_prime_approx = 329.3667035605685
f_prime_exact = 329.36669915503717
x = 5.797, abs. error = 4.406e-06, rel. error = 1.338e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.033e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 372.52458634734387
f_prime_exact = 372.52458301121044
x = 5.920, abs. error = 3.336e-06, rel. error = 8.955e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.062e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.015e-08
Number of iterations = 0
f_prime_approx = 421.3375759382951
f_prime_exact = 421.3375708706767
x = 6.043, abs. error = 5.068e-06, rel. error = 1.203e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.353e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.992e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.998e-08
Number of iterations = 0
f_prime_approx = 476.5466739047366
f_prime_exact = 476.54666758424383
x = 6.167, abs. error = 6.320e-06, rel. error = 1.326e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 1.896e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.035e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.009e-08
Number of iterations = 0
f_prime_approx = 538.9899773682508
f_prime_exact = 538.9899740399652
x = 6.290, abs. error = 3.328e-06, rel. error = 6.175e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.145e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.125e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.031e-08
Number of iterations = 0
f_prime_approx = 609.6154154834254
f_prime_exact = 609.6154099414529
x = 6.413, abs. error = 5.542e-06, rel. error = 9.091e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.977e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.994e-08
Number of iterations = 0
f_prime_approx = 689.4951097737229
f_prime_exact = 689.4951036891268
x = 6.536, abs. error = 6.085e-06, rel. error = 8.825e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.744e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.920e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.980e-08
Number of iterations = 0
f_prime_approx = 779.8416804368192
f_prime_exact = 779.8416678097716
x = 6.659, abs. error = 1.263e-05, rel. error = 1.619e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.030e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 882.0266174559615
f_prime_exact = 882.0266070033241
x = 6.782, abs. error = 1.045e-05, rel. error = 1.185e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.510e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.034e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.009e-08
Number of iterations = 0
f_prime_approx = 997.6011475650502
f_prime_exact = 997.6011382499878
x = 6.905, abs. error = 9.315e-06, rel. error = 9.337e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.970e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.992e-08
Number of iterations = 0
f_prime_approx = 1128.3197531941196
f_prime_exact = 1128.3197390369876
x = 7.028, abs. error = 1.416e-05, rel. error = 1.255e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.939e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.985e-08
Number of iterations = 0
f_prime_approx = 1276.1667895962255
f_prime_exact = 1276.1667811785012
x = 7.152, abs. error = 8.418e-06, rel. error = 6.596e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.968e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.992e-08
Number of iterations = 0
f_prime_approx = 1443.3866770686575
f_prime_exact = 1443.3866545430617
x = 7.275, abs. error = 2.253e-05, rel. error = 1.561e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.989e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 1632.5178510439673
f_prime_exact = 1632.517837981244
x = 7.398, abs. error = 1.306e-05, rel. error = 8.002e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.010e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.003e-08
Number of iterations = 0
f_prime_approx = 1846.431457211488
f_prime_exact = 1846.4314346668687
x = 7.521, abs. error = 2.254e-05, rel. error = 1.221e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.993e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.998e-08
Number of iterations = 0
f_prime_approx = 2088.3747766768915
f_prime_exact = 2088.374756836879
x = 7.644, abs. error = 1.984e-05, rel. error = 9.500e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.995e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.999e-08
Number of iterations = 0
f_prime_approx = 2362.020649088795
f_prime_exact = 2362.0206215674402
x = 7.767, abs. error = 2.752e-05, rel. error = 1.165e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.350e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.983e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.996e-08
Number of iterations = 0
f_prime_approx = 2671.5231369114335
f_prime_exact = 2671.5231059200228
x = 7.890, abs. error = 3.099e-05, rel. error = 1.160e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.967e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.992e-08
Number of iterations = 0
f_prime_approx = 3021.5806381068205
f_prime_exact = 3021.5806078477076
x = 8.014, abs. error = 3.026e-05, rel. error = 1.001e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.008e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.002e-08
Number of iterations = 0
f_prime_approx = 3417.5072094247703
f_prime_exact = 3417.5071701568327
x = 8.137, abs. error = 3.927e-05, rel. error = 1.149e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 3.400e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.000e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.000e-08
Number of iterations = 0
f_prime_approx = 3865.313184844544
f_prime_exact = 3865.313150256364
x = 8.260, abs. error = 3.459e-05, rel. error = 8.948e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.006e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.001e-08
Number of iterations = 0
f_prime_approx = 4371.796489559483
f_prime_exact = 4371.796460300949
x = 8.383, abs. error = 2.926e-05, rel. error = 6.693e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.027e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.007e-08
Number of iterations = 0
f_prime_approx = 4944.645811626237
f_prime_exact = 4944.645762797331
x = 8.506, abs. error = 4.883e-05, rel. error = 9.875e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.460e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.032e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 5592.5572355205195
f_prime_exact = 5592.557188233446
x = 8.629, abs. error = 4.729e-05, rel. error = 8.455e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.032e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 6325.366429955118
f_prime_exact = 6325.366346560564
x = 8.752, abs. error = 8.339e-05, rel. error = 1.318e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.034e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.008e-08
Number of iterations = 0
f_prime_approx = 7154.197726606585
f_prime_exact = 7154.197636526858
x = 8.875, abs. error = 9.008e-05, rel. error = 1.259e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.954e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.989e-08
Number of iterations = 0
f_prime_approx = 8091.633210470089
f_prime_exact = 8091.633119450407
x = 8.999, abs. error = 9.102e-05, rel. error = 1.125e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.013e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.025e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 9151.903656018781
f_prime_exact = 9151.90352101771
x = 9.122, abs. error = 1.350e-04, rel. error = 1.475e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.276e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.065e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.016e-08
Number of iterations = 0
f_prime_approx = 10351.104318170424
f_prime_exact = 10351.104260607543
x = 9.245, abs. error = 5.756e-05, rel. error = 5.561e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.023e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 11707.439956247661
f_prime_exact = 11707.439787570336
x = 9.368, abs. error = 1.687e-04, rel. error = 1.441e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.044e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.011e-08
Number of iterations = 0
f_prime_approx = 13241.500034228247
f_prime_exact = 13241.499933606137
x = 9.491, abs. error = 1.006e-04, rel. error = 7.599e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.016e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.004e-08
Number of iterations = 0
f_prime_approx = 14976.572576448476
f_prime_exact = 14976.572476404686
x = 9.614, abs. error = 1.000e-04, rel. error = 6.680e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.963e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.991e-08
Number of iterations = 0
f_prime_approx = 16938.996882931042
f_prime_exact = 16938.996659415337
x = 9.737, abs. error = 2.235e-04, rel. error = 1.320e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.975e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.994e-08
Number of iterations = 0
f_prime_approx = 19158.56316903247
f_prime_exact = 19158.563034348233
x = 9.861, abs. error = 1.347e-04, rel. error = 7.030e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.383e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.108e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.027e-08
Number of iterations = 0
f_prime_approx = 21668.96585374832
f_prime_exact = 21668.965696210464
x = 9.984, abs. error = 1.575e-04, rel. error = 7.270e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.963e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.991e-08
Number of iterations = 0
f_prime_approx = 24508.31405880364
f_prime_exact = 24508.313776024206
x = 10.107, abs. error = 2.828e-04, rel. error = 1.154e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.958e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.990e-08
Number of iterations = 0
f_prime_approx = 27719.71033686824
f_prime_exact = 27719.70995593499
x = 10.230, abs. error = 3.809e-04, rel. error = 1.374e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.008e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.002e-08
Number of iterations = 0
f_prime_approx = 31351.9051618616
f_prime_exact = 31351.904788849584
x = 10.353, abs. error = 3.730e-04, rel. error = 1.190e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.978e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.995e-08
Number of iterations = 0
f_prime_approx = 35460.03707918793
f_prime_exact = 35460.036755493995
x = 10.476, abs. error = 3.237e-04, rel. error = 9.128e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.009e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.002e-08
Number of iterations = 0
f_prime_approx = 40106.469676093715
f_prime_exact = 40106.46929331679
x = 10.599, abs. error = 3.828e-04, rel. error = 9.544e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.022e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 45361.73793503671
f_prime_exact = 45361.73750374202
x = 10.722, abs. error = 4.313e-04, rel. error = 9.508e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.821e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.029e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.007e-08
Number of iterations = 0
f_prime_approx = 51305.6193479579
f_prime_exact = 51305.61890924868
x = 10.846, abs. error = 4.387e-04, rel. error = 8.551e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.988e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.997e-08
Number of iterations = 0
f_prime_approx = 58028.34521039318
f_prime_exact = 58028.34451488785
x = 10.969, abs. error = 6.955e-04, rel. error = 1.199e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 1.804e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.100e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.025e-08
Number of iterations = 0
f_prime_approx = 65631.96883406903
f_prime_exact = 65631.96855874031
x = 11.092, abs. error = 2.753e-04, rel. error = 4.195e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.040e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.081e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.020e-08
Number of iterations = 0
f_prime_approx = 74231.91805595063
f_prime_exact = 74231.91774478974
x = 11.215, abs. error = 3.112e-04, rel. error = 4.192e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.979e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.995e-08
Number of iterations = 0
f_prime_approx = 83958.7441591778
f_prime_exact = 83958.74347632064
x = 11.338, abs. error = 6.829e-04, rel. error = 8.133e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.016e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.004e-08
Number of iterations = 0
f_prime_approx = 94960.10466445105
f_prime_exact = 94960.10368959374
x = 11.461, abs. error = 9.749e-04, rel. error = 1.027e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.952e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.936e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.984e-08
Number of iterations = 0
f_prime_approx = 107403.00562060768
f_prime_exact = 107403.00437299456
x = 11.584, abs. error = 1.248e-03, rel. error = 1.162e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.023e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.006e-08
Number of iterations = 0
f_prime_approx = 121476.33603374472
f_prime_exact = 121476.3347990068
x = 11.707, abs. error = 1.235e-03, rel. error = 1.016e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 1.888e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 3.934e-02
  c in [0.001, 0.1]: stop!
Computed step = 1.983e-08
Number of iterations = 0
f_prime_approx = 137393.73681119774
f_prime_exact = 137393.73495505998
x = 11.831, abs. error = 1.856e-03, rel. error = 1.351e-08, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.030e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.007e-08
Number of iterations = 0
f_prime_approx = 155396.83940901345
f_prime_exact = 155396.8387022461
x = 11.954, abs. error = 7.068e-04, rel. error = 4.548e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = 2.416e+00
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.094e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.023e-08
Number of iterations = 0
f_prime_approx = 175758.94272226808
f_prime_exact = 175758.941894625
x = 12.077, abs. error = 8.276e-04, rel. error = 4.709e-09, Func. eval. = 12
kmin = 1.000e-13, c(kmin) = inf
kmax = 1.000e-01, c(kmax) = 3.997e-14
Iter #0, kmin = 1.000e-13, kmax = 1.000e-01, k = 1.000e-07, c(k) = 4.018e-02
  c in [0.001, 0.1]: stop!
Computed step = 2.004e-08
Number of iterations = 0
f_prime_approx = 198789.15250293532
f_prime_exact = 198789.1511429544
x = 12.200, abs. error = 1.360e-03, rel. error = 6.841e-09, Func. eval. = 12
Average error = 1.0306611027792858e-08
Average number of function evaluations = 12.0
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_error_vs_h_with_GMSW_steps</span><span class="p">(</span>
    <span class="n">name</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">function_derivative</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">):</span>
    <span class="n">algorithm</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GillMurraySaundersWright</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">number_of_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_array</span><span class="p">)</span>
    <span class="n">error_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">number_of_points</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_points</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">h_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">f_prime_approx</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">compute_first_derivative</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="n">error_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_prime_approx</span> <span class="o">-</span> <span class="n">function_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="n">step</span><span class="p">,</span> <span class="n">number_of_iterations</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span><span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step h* = </span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">number_of_iterations</span><span class="si">}</span><span class="s2"> iterations&quot;</span><span class="p">)</span>

    <span class="n">minimum_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">error_array</span><span class="p">)</span>
    <span class="n">maximum_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">error_array</span><span class="p">)</span>

    <span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h_array</span><span class="p">,</span> <span class="n">error_array</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">[</span><span class="n">minimum_error</span><span class="p">,</span> <span class="n">maximum_error</span><span class="p">],</span>
        <span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$\hat</span><span class="si">{h}</span><span class="s2">$&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(GMS &amp; W). </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> at point x = </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">plot_error_vs_h_with_GMSW_steps</span><span class="p">(</span>
        <span class="n">benchmark</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">benchmark</span><span class="o">.</span><span class="n">function</span><span class="p">,</span>
        <span class="n">benchmark</span><span class="o">.</span><span class="n">first_derivative</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">h_array</span><span class="p">,</span>
        <span class="n">kmin</span><span class="p">,</span>
        <span class="n">kmax</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">ExponentialProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">number_of_points</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-15</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_001.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_001.png" alt="(GMS & W). exp at point x = 1.0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>exp
Step h* = 1.999e-08 using 2 iterations
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_002.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_002.png" alt="(GMS & W). exp at point x = 12.0" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">ScaledExponentialProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-10</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e8</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_003.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_003.png" alt="(GMS & W). scaled exp at point x = 1.0" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">LogarithmicProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-14</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_004.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_004.png" alt="(GMS & W). log at point x = 1.1" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>log
Step h* = 6.824e-09 using 0 iterations
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">SinProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-15</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_005.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_005.png" alt="(GMS & W). sin at point x = 1.0" class = "sphx-glr-single-img"/><div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">SquareRootProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-15</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_006.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_006.png" alt="(GMS & W). sqrt at point x = 1.0" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>sqrt
Step h* = 3.997e-08 using 2 iterations
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">benchmark</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">AtanProblem</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.1</span>
<span class="n">kmin</span> <span class="o">=</span> <span class="mf">1.0e-15</span>
<span class="n">kmax</span> <span class="o">=</span> <span class="mf">1.0e-1</span>
<span class="n">h_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">number_of_points</span><span class="p">)</span>
<span class="n">plot_error_vs_h_benchmark</span><span class="p">(</span><span class="n">benchmark</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_array</span><span class="p">,</span> <span class="n">kmin</span><span class="p">,</span> <span class="n">kmax</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_gill_murray_saunders_wright_007.png" srcset="../_images/sphx_glr_plot_gill_murray_saunders_wright_007.png" alt="(GMS & W). atan at point x = 1.1" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 1.451 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-example-plot-gill-murray-saunders-wright-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2353d809f4356f9b0bbe3361aa40f871/plot_gill_murray_saunders_wright.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_gill_murray_saunders_wright.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c25a0f2f8d4ac18168a606d7c59420e9/plot_gill_murray_saunders_wright.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_gill_murray_saunders_wright.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0434498d654eb9b13ee66b994a69bce3/plot_gill_murray_saunders_wright.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_gill_murray_saunders_wright.zip</span></code></a></p>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">numericalderivative</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/user_manual.html">User manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../examples/examples.html">Examples</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../examples/examples.html">Examples</a><ul>
      <li>Previous: <a href="plot_dumontet_vignes_benchmark.html" title="previous chapter">Benchmark Dumontet &amp; Vignes method</a></li>
      <li>Next: <a href="plot_gill_murray_saunders_wright_benchmark.html" title="next chapter">Benchmark Gill, Murray, Saunders and Wright method</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;M. Baudin.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/auto_example/plot_gill_murray_saunders_wright.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>