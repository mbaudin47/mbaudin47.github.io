<!DOCTYPE html>

<html lang="python" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Use the generalized finite differences formulas &#8212; numericalderivative 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=8cfa8c60"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/Icon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Convergence of the generalized finite differences formulas" href="plot_general_fd_convergence.html" />
    <link rel="prev" title="Use the finite differences formulas" href="plot_finite_differences.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-example-plot-general-fd-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="use-the-generalized-finite-differences-formulas">
<span id="sphx-glr-auto-example-plot-general-fd-py"></span><h1>Use the generalized finite differences formulas<a class="headerlink" href="#use-the-generalized-finite-differences-formulas" title="Link to this heading">¶</a></h1>
<p>This example shows how to use generalized finite difference (F.D.) formulas.</p>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><ol class="upperalpha simple" start="13">
<li><p>Baudin (2023). Méthodes numériques. Dunod.</p></li>
</ol>
</li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numericalderivative</span> <span class="k">as</span> <span class="nn">nd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">tabulate</span>
</pre></div>
</div>
</section>
<section id="compute-the-first-derivative-using-forward-f-d-formula">
<h2>Compute the first derivative using forward F.D. formula<a class="headerlink" href="#compute-the-first-derivative-using-forward-f-d-formula" title="Link to this heading">¶</a></h2>
<p>This is the function we want to compute the derivative of.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scaled_exp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0e6</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
<p>Use the F.D. formula for f'(x)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">differentiation_order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">formula_accuracy</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
    <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">,</span> <span class="s2">&quot;central&quot;</span>
<span class="p">)</span>
<span class="n">step</span> <span class="o">=</span> <span class="mf">1.0e-3</span>  <span class="c1"># A first guess</span>
<span class="n">f_prime_approx</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximate f&#39;(x) = </span><span class="si">{</span><span class="n">f_prime_approx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Approximate f&#39;(x) = -9.999989725173464e-07
</pre></div>
</div>
<p>To check our result, we define the exact first derivative.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scaled_exp_prime</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0e6</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">alpha</span>
</pre></div>
</div>
<p>Compute the exact derivative and the absolute error.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">f_prime_exact</span> <span class="o">=</span> <span class="n">scaled_exp_prime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exact f&#39;(x) = </span><span class="si">{</span><span class="n">f_prime_exact</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">absolute_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_prime_approx</span> <span class="o">-</span> <span class="n">f_prime_exact</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absolute error = </span><span class="si">{</span><span class="n">absolute_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Exact f&#39;(x) = -9.999990000005e-07
Absolute error = 2.7483153726165933e-14
</pre></div>
</div>
<p>Define the error function: this will be useful later.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_absolute_error</span><span class="p">(</span>
    <span class="n">step</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">differentiation_order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">formula_accuracy</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;central&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
        <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">,</span> <span class="n">direction</span>
    <span class="p">)</span>
    <span class="n">f_prime_approx</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    <span class="n">f_prime_exact</span> <span class="o">=</span> <span class="n">scaled_exp_prime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">absolute_error</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f_prime_approx</span> <span class="o">-</span> <span class="n">f_prime_exact</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximate f&#39;(x) = </span><span class="si">{</span><span class="n">f_prime_approx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exact f&#39;(x) = </span><span class="si">{</span><span class="n">f_prime_exact</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absolute error = </span><span class="si">{</span><span class="n">absolute_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">absolute_error</span>
</pre></div>
</div>
</section>
<section id="compute-the-exact-step-for-the-forward-f-d-formula">
<h2>Compute the exact step for the forward F.D. formula<a class="headerlink" href="#compute-the-exact-step-for-the-forward-f-d-formula" title="Link to this heading">¶</a></h2>
<p>This step depends on the second derivative.
Firstly, we assume that this is unknown and use a first
guess of it, equal to 1.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">differentiation_order</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">formula_accuracy</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;central&quot;</span>
<span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
    <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">,</span> <span class="n">direction</span>
<span class="p">)</span>
<span class="n">second_derivative_value</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># A first guess</span>
<span class="n">step</span><span class="p">,</span> <span class="n">absolute_error</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span><span class="n">second_derivative_value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximately optimal step (using f&#39;&#39;(x) = 1) = </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximately absolute error = </span><span class="si">{</span><span class="n">absolute_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">compute_absolute_error</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Approximately optimal step (using f&#39;&#39;(x) = 1) = 8.733476581980381e-06
Approximately absolute error = 3.8136806603999814e-11
Approximate f&#39;(x) = -9.999979182323467e-07
Exact f&#39;(x) = -9.999990000005e-07
Absolute error = 1.081768153431351e-12
</pre></div>
</div>
<p>We see that the new step is much better than the our initial guess:
the approximately optimal step is much smaller, which leads to a smaller
absolute error.</p>
<p>In our particular example, the second derivative is known: let's use
this information and compute the exactly optimal step.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scaled_exp_2nd_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0e6</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">second_derivative_value</span> <span class="o">=</span> <span class="n">scaled_exp_2nd_derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exact second derivative f&#39;&#39;(x) = </span><span class="si">{</span><span class="n">second_derivative_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">step</span><span class="p">,</span> <span class="n">absolute_error</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">compute_step</span><span class="p">(</span><span class="n">second_derivative_value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximately optimal step (using f&#39;&#39;(x) = 1) = </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Approximately absolute error = </span><span class="si">{</span><span class="n">absolute_error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">compute_absolute_error</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Exact second derivative f&#39;&#39;(x) = 9.999990000005e-13
Approximately optimal step (using f&#39;&#39;(x) = 1) = 0.08733479493139723
Approximately absolute error = 3.813679389173307e-15
Approximate f&#39;(x) = -9.999989997748166e-07
Exact f&#39;(x) = -9.999990000005e-07
Absolute error = 2.256834584664358e-16
</pre></div>
</div>
</section>
<section id="compute-the-coefficients-of-several-central-f-d-formulas">
<h2>Compute the coefficients of several central F.D. formulas<a class="headerlink" href="#compute-the-coefficients-of-several-central-f-d-formulas" title="Link to this heading">¶</a></h2>
<p>We would like to compute the coefficients of a collection of central
finite difference formulas.</p>
<p>We consider the differentation order up to the sixth derivative
and the central F.D. formula up to the order 8.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_differentiation_order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">formula_accuracy_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>We want to the print the result as a table.
This is the reason why we need to align the coefficients on the
columns on the table.</p>
<p>First pass: compute the maximum number of coefficients.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_number_of_coefficients</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;central&quot;</span>
<span class="n">coefficients_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">differentiation_order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_differentiation_order</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">formula_accuracy</span> <span class="ow">in</span> <span class="n">formula_accuracy_list</span><span class="p">:</span>
        <span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
            <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">,</span> <span class="n">direction</span>
        <span class="p">)</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span>
        <span class="n">coefficients_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
        <span class="n">maximum_number_of_coefficients</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">maximum_number_of_coefficients</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Second pass: compute the maximum number of coefficients</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">differentiation_order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_differentiation_order</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">formula_accuracy</span> <span class="ow">in</span> <span class="n">formula_accuracy_list</span><span class="p">:</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">coefficients_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">]</span>
        <span class="n">padding_number</span> <span class="o">=</span> <span class="n">maximum_number_of_coefficients</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">padding_number</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coefficients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Derivative&quot;</span><span class="p">,</span> <span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_number_of_coefficients</span><span class="p">):</span>
    <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">maximum_number_of_coefficients</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
<thead>
<tr><th style="text-align: right;">  Derivative</th><th style="text-align: right;">  Accuracy</th><th>-6    </th><th>-5    </th><th>-4    </th><th>-3    </th><th>-2    </th><th style="text-align: right;">    -1</th><th style="text-align: right;">     0</th><th style="text-align: right;">     1</th><th style="text-align: right;">     2</th><th style="text-align: right;">     3</th><th style="text-align: right;">     4</th><th style="text-align: right;">     5</th><th style="text-align: right;">  6</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>      </td><td style="text-align: right;">-0.5  </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>      </td><td>0.083 </td><td style="text-align: right;">-0.667</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-0.083</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>      </td><td>-0.017</td><td>0.150 </td><td style="text-align: right;">-0.75 </td><td style="text-align: right;">-0    </td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-0.15 </td><td style="text-align: right;"> 0.017</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         8</td><td>      </td><td>      </td><td>0.004 </td><td>-0.038</td><td>0.200 </td><td style="text-align: right;">-0.8  </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-0.2  </td><td style="text-align: right;"> 0.038</td><td style="text-align: right;">-0.004</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>      </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">-1    </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>      </td><td>-0.042</td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-1.25 </td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-0.042</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>      </td><td>0.006 </td><td>-0.075</td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-1.361</td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-0.075</td><td style="text-align: right;"> 0.006</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         8</td><td>      </td><td>      </td><td>-0.001</td><td>0.013 </td><td>-0.100</td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-1.424</td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-0.1  </td><td style="text-align: right;"> 0.013</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>-0.083</td><td style="text-align: right;"> 0.167</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.083</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>0.021 </td><td>-0.167</td><td style="text-align: right;"> 0.271</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.167</td><td style="text-align: right;">-0.021</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>-0.005</td><td>0.050 </td><td>-0.235</td><td style="text-align: right;"> 0.339</td><td style="text-align: right;">-0    </td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.235</td><td style="text-align: right;">-0.05 </td><td style="text-align: right;"> 0.005</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         8</td><td>      </td><td>0.001 </td><td>-0.014</td><td>0.081 </td><td>-0.289</td><td style="text-align: right;"> 0.386</td><td style="text-align: right;">-0    </td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.289</td><td style="text-align: right;">-0.081</td><td style="text-align: right;"> 0.014</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>0.042 </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.25 </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.042</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>-0.007</td><td>0.083 </td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.389</td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.083</td><td style="text-align: right;">-0.007</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>0.001 </td><td>-0.017</td><td>0.117 </td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.474</td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.117</td><td style="text-align: right;">-0.017</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         8</td><td>      </td><td>-0.000</td><td>0.003 </td><td>-0.027</td><td>0.144 </td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.531</td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.144</td><td style="text-align: right;">-0.027</td><td style="text-align: right;"> 0.003</td><td style="text-align: right;">-0    </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>-0.004</td><td>0.017 </td><td style="text-align: right;">-0.021</td><td style="text-align: right;">-0    </td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.017</td><td style="text-align: right;"> 0.004</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>0.001 </td><td>-0.013</td><td>0.036 </td><td style="text-align: right;">-0.04 </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.036</td><td style="text-align: right;"> 0.012</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         6</td><td>      </td><td>-0.000</td><td>0.004 </td><td>-0.023</td><td>0.054 </td><td style="text-align: right;">-0.056</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.054</td><td style="text-align: right;"> 0.023</td><td style="text-align: right;">-0.004</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         8</td><td>0.000 </td><td>-0.001</td><td>0.009 </td><td>-0.033</td><td>0.070 </td><td style="text-align: right;">-0.069</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.07 </td><td style="text-align: right;"> 0.033</td><td style="text-align: right;">-0.009</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;"> -0</td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>0.001 </td><td>-0.008</td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.028</td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.008</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>-0.000</td><td>0.004 </td><td>-0.018</td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.052</td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.018</td><td style="text-align: right;"> 0.004</td><td style="text-align: right;">-0    </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         6</td><td>      </td><td>0.000 </td><td>-0.001</td><td>0.008 </td><td>-0.027</td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.071</td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.027</td><td style="text-align: right;"> 0.008</td><td style="text-align: right;">-0.001</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">   </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         8</td><td>-0.000</td><td>0.000 </td><td>-0.002</td><td>0.011 </td><td>-0.035</td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.086</td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.035</td><td style="text-align: right;"> 0.011</td><td style="text-align: right;">-0.002</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> -0</td></tr>
</tbody>
</table>
</div>
<br />
<br /><p>We notice that the sum of the coefficients is zero.
Furthermore, consider the properties of the coefficients with respect to the
center coefficient of index <span class="math notranslate nohighlight">\(i = 0\)</span>.</p>
<ul class="simple">
<li><p>If the differentiation order <span class="math notranslate nohighlight">\(d\)</span> is odd (e.g. <span class="math notranslate nohighlight">\(d = 3\)</span>),
then the symetrical coefficients are of opposite signs.
In this case, <span class="math notranslate nohighlight">\(c_0 = 0\)</span>.</p></li>
<li><p>If the differentiation order <span class="math notranslate nohighlight">\(d\)</span> is even (e.g. <span class="math notranslate nohighlight">\(d = 4\)</span>),
then the symetrical coefficients are equal.</p></li>
</ul>
<p>Make a plot of the coefficients depending on the indices.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_differentiation_order</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">formula_accuracy_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;central&quot;</span>
<span class="n">color_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mcolors</span><span class="o">.</span><span class="n">TABLEAU_COLORS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">]</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Central finite difference&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">differentiation_order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_differentiation_order</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">formula_accuracy_list</span><span class="p">)):</span>
        <span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
            <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy_list</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">direction</span>
        <span class="p">)</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span>
        <span class="n">imin</span><span class="p">,</span> <span class="n">imax</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_indices_min_max</span><span class="p">()</span>
        <span class="n">this_label</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$d = &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">differentiation_order</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">r</span><span class="s2">&quot;$, $p = &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formula_accuracy_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">r</span><span class="s2">&quot;$&quot;</span>
        <span class="p">)</span>
        <span class="n">this_color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">differentiation_order</span><span class="p">]</span>
        <span class="n">this_marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span> <span class="n">imax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">coefficients</span><span class="p">,</span>
            <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">this_marker</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">this_color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">this_label</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$i$&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$c_i$&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_general_fd_001.png" srcset="../_images/sphx_glr_plot_general_fd_001.png" alt="Central finite difference" class = "sphx-glr-single-img"/></section>
<section id="compute-the-coefficients-of-several-forward-f-d-formulas">
<h2>Compute the coefficients of several forward F.D. formulas<a class="headerlink" href="#compute-the-coefficients-of-several-forward-f-d-formulas" title="Link to this heading">¶</a></h2>
<p>We would like to compute the coefficients of a collection of forward
finite difference formulas.</p>
<p>We consider the differentation order up to the sixth derivative
and the forward F.D. formula up to the order 8.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_differentiation_order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">formula_accuracy_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<p>We want to the print the result as a table.
This is the reason why we need to align the coefficients on the
columns on the table.</p>
<p>First pass: compute the maximum number of coefficients.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_number_of_coefficients</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">differentiation_order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_differentiation_order</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">formula_accuracy</span> <span class="ow">in</span> <span class="n">formula_accuracy_list</span><span class="p">:</span>
        <span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
            <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">,</span> <span class="n">direction</span>
        <span class="p">)</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span>
        <span class="n">maximum_number_of_coefficients</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">maximum_number_of_coefficients</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">coefficients</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Derivative&quot;</span><span class="p">,</span> <span class="s2">&quot;Accuracy&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_number_of_coefficients</span><span class="p">):</span>
    <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="n">tabulate</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
<thead>
<tr><th style="text-align: right;">  Derivative</th><th style="text-align: right;">  Accuracy</th><th style="text-align: right;">     0</th><th style="text-align: right;">      1</th><th style="text-align: right;">      2</th><th style="text-align: right;">      3</th><th style="text-align: right;">      4</th><th style="text-align: right;">      5</th><th style="text-align: right;">      6</th><th style="text-align: right;">      7</th><th style="text-align: right;">      8</th><th style="text-align: right;">     9</th><th style="text-align: right;">    10</th><th style="text-align: right;">    11</th><th style="text-align: right;">   12</th></tr>
</thead>
<tbody>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         1</td><td style="text-align: right;">-1    </td><td style="text-align: right;">  1    </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         2</td><td style="text-align: right;">-1.5  </td><td style="text-align: right;">  2    </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         3</td><td style="text-align: right;">-1.833</td><td style="text-align: right;">  3    </td><td style="text-align: right;"> -1.5  </td><td style="text-align: right;">  0.333</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         4</td><td style="text-align: right;">-2.083</td><td style="text-align: right;">  4    </td><td style="text-align: right;"> -3    </td><td style="text-align: right;">  1.333</td><td style="text-align: right;"> -0.25 </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         5</td><td style="text-align: right;">-2.283</td><td style="text-align: right;">  5    </td><td style="text-align: right;"> -5    </td><td style="text-align: right;">  3.333</td><td style="text-align: right;"> -1.25 </td><td style="text-align: right;">  0.2  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         6</td><td style="text-align: right;">-2.45 </td><td style="text-align: right;">  6    </td><td style="text-align: right;"> -7.5  </td><td style="text-align: right;">  6.667</td><td style="text-align: right;"> -3.75 </td><td style="text-align: right;">  1.2  </td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           1</td><td style="text-align: right;">         7</td><td style="text-align: right;">-2.593</td><td style="text-align: right;">  7    </td><td style="text-align: right;">-10.5  </td><td style="text-align: right;"> 11.667</td><td style="text-align: right;"> -8.75 </td><td style="text-align: right;">  4.2  </td><td style="text-align: right;"> -1.167</td><td style="text-align: right;">  0.143</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;"> -1    </td><td style="text-align: right;">  0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 1    </td><td style="text-align: right;"> -2.5  </td><td style="text-align: right;">  2    </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 1.458</td><td style="text-align: right;"> -4.333</td><td style="text-align: right;">  4.75 </td><td style="text-align: right;"> -2.333</td><td style="text-align: right;">  0.458</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 1.875</td><td style="text-align: right;"> -6.417</td><td style="text-align: right;">  8.917</td><td style="text-align: right;"> -6.5  </td><td style="text-align: right;">  2.542</td><td style="text-align: right;"> -0.417</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 2.256</td><td style="text-align: right;"> -8.7  </td><td style="text-align: right;"> 14.625</td><td style="text-align: right;">-14.111</td><td style="text-align: right;">  8.25 </td><td style="text-align: right;"> -2.7  </td><td style="text-align: right;">  0.381</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 2.606</td><td style="text-align: right;">-11.15 </td><td style="text-align: right;"> 21.975</td><td style="text-align: right;">-26.361</td><td style="text-align: right;"> 20.5  </td><td style="text-align: right;">-10.05 </td><td style="text-align: right;">  2.831</td><td style="text-align: right;"> -0.35 </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           2</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 2.93 </td><td style="text-align: right;">-13.743</td><td style="text-align: right;"> 31.05 </td><td style="text-align: right;">-44.511</td><td style="text-align: right;"> 43.188</td><td style="text-align: right;">-28.2  </td><td style="text-align: right;"> 11.906</td><td style="text-align: right;"> -2.943</td><td style="text-align: right;">  0.324</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         1</td><td style="text-align: right;">-0.167</td><td style="text-align: right;">  0.5  </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">  0.167</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         2</td><td style="text-align: right;">-0.417</td><td style="text-align: right;">  1.5  </td><td style="text-align: right;"> -2    </td><td style="text-align: right;">  1.167</td><td style="text-align: right;"> -0.25 </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         3</td><td style="text-align: right;">-0.708</td><td style="text-align: right;">  2.958</td><td style="text-align: right;"> -4.917</td><td style="text-align: right;">  4.083</td><td style="text-align: right;"> -1.708</td><td style="text-align: right;">  0.292</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         4</td><td style="text-align: right;">-1.021</td><td style="text-align: right;">  4.833</td><td style="text-align: right;"> -9.604</td><td style="text-align: right;"> 10.333</td><td style="text-align: right;"> -6.396</td><td style="text-align: right;">  2.167</td><td style="text-align: right;"> -0.312</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         5</td><td style="text-align: right;">-1.343</td><td style="text-align: right;">  7.089</td><td style="text-align: right;">-16.371</td><td style="text-align: right;"> 21.611</td><td style="text-align: right;">-17.674</td><td style="text-align: right;">  8.933</td><td style="text-align: right;"> -2.568</td><td style="text-align: right;">  0.322</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         6</td><td style="text-align: right;">-1.669</td><td style="text-align: right;">  9.694</td><td style="text-align: right;">-25.49 </td><td style="text-align: right;"> 39.85 </td><td style="text-align: right;">-40.472</td><td style="text-align: right;"> 27.172</td><td style="text-align: right;">-11.688</td><td style="text-align: right;">  2.928</td><td style="text-align: right;"> -0.326</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           3</td><td style="text-align: right;">         7</td><td style="text-align: right;">-1.994</td><td style="text-align: right;"> 12.624</td><td style="text-align: right;">-37.209</td><td style="text-align: right;"> 67.194</td><td style="text-align: right;">-81.487</td><td style="text-align: right;"> 68.187</td><td style="text-align: right;">-39.031</td><td style="text-align: right;"> 14.646</td><td style="text-align: right;"> -3.255</td><td style="text-align: right;"> 0.326</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.042</td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">  0.25 </td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">  0.042</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 0.125</td><td style="text-align: right;"> -0.583</td><td style="text-align: right;">  1.083</td><td style="text-align: right;"> -1    </td><td style="text-align: right;">  0.458</td><td style="text-align: right;"> -0.083</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 0.243</td><td style="text-align: right;"> -1.292</td><td style="text-align: right;">  2.854</td><td style="text-align: right;"> -3.361</td><td style="text-align: right;">  2.229</td><td style="text-align: right;"> -0.792</td><td style="text-align: right;">  0.118</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 0.389</td><td style="text-align: right;"> -2.312</td><td style="text-align: right;">  5.917</td><td style="text-align: right;"> -8.465</td><td style="text-align: right;">  7.333</td><td style="text-align: right;"> -3.854</td><td style="text-align: right;">  1.139</td><td style="text-align: right;"> -0.146</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 0.557</td><td style="text-align: right;"> -3.656</td><td style="text-align: right;"> 10.617</td><td style="text-align: right;">-17.867</td><td style="text-align: right;"> 19.085</td><td style="text-align: right;">-13.256</td><td style="text-align: right;">  5.84 </td><td style="text-align: right;"> -1.489</td><td style="text-align: right;">  0.168</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 0.742</td><td style="text-align: right;"> -5.324</td><td style="text-align: right;"> 17.292</td><td style="text-align: right;">-33.442</td><td style="text-align: right;"> 42.448</td><td style="text-align: right;">-36.618</td><td style="text-align: right;"> 21.415</td><td style="text-align: right;"> -8.164</td><td style="text-align: right;">  1.837</td><td style="text-align: right;">-0.185</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           4</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 0.942</td><td style="text-align: right;"> -7.319</td><td style="text-align: right;"> 26.267</td><td style="text-align: right;">-57.373</td><td style="text-align: right;"> 84.327</td><td style="text-align: right;">-86.874</td><td style="text-align: right;"> 63.294</td><td style="text-align: right;">-32.095</td><td style="text-align: right;"> 10.811</td><td style="text-align: right;">-2.18 </td><td style="text-align: right;"> 0.199</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         1</td><td style="text-align: right;">-0.008</td><td style="text-align: right;">  0.042</td><td style="text-align: right;"> -0.083</td><td style="text-align: right;">  0.083</td><td style="text-align: right;"> -0.042</td><td style="text-align: right;">  0.008</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         2</td><td style="text-align: right;">-0.029</td><td style="text-align: right;">  0.167</td><td style="text-align: right;"> -0.396</td><td style="text-align: right;">  0.5  </td><td style="text-align: right;"> -0.354</td><td style="text-align: right;">  0.133</td><td style="text-align: right;"> -0.021</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         3</td><td style="text-align: right;">-0.064</td><td style="text-align: right;">  0.41 </td><td style="text-align: right;"> -1.125</td><td style="text-align: right;">  1.715</td><td style="text-align: right;"> -1.569</td><td style="text-align: right;">  0.862</td><td style="text-align: right;"> -0.264</td><td style="text-align: right;">  0.035</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         4</td><td style="text-align: right;">-0.113</td><td style="text-align: right;">  0.799</td><td style="text-align: right;"> -2.486</td><td style="text-align: right;">  4.438</td><td style="text-align: right;"> -4.972</td><td style="text-align: right;">  3.585</td><td style="text-align: right;"> -1.625</td><td style="text-align: right;">  0.424</td><td style="text-align: right;"> -0.049</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         5</td><td style="text-align: right;">-0.174</td><td style="text-align: right;">  1.355</td><td style="text-align: right;"> -4.713</td><td style="text-align: right;">  9.634</td><td style="text-align: right;">-12.767</td><td style="text-align: right;"> 11.38 </td><td style="text-align: right;"> -6.822</td><td style="text-align: right;">  2.651</td><td style="text-align: right;"> -0.605</td><td style="text-align: right;"> 0.062</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         6</td><td style="text-align: right;">-0.249</td><td style="text-align: right;">  2.098</td><td style="text-align: right;"> -8.053</td><td style="text-align: right;"> 18.54 </td><td style="text-align: right;">-28.353</td><td style="text-align: right;"> 30.083</td><td style="text-align: right;">-22.407</td><td style="text-align: right;"> 11.557</td><td style="text-align: right;"> -3.945</td><td style="text-align: right;"> 0.804</td><td style="text-align: right;">-0.074</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           5</td><td style="text-align: right;">         7</td><td style="text-align: right;">-0.334</td><td style="text-align: right;">  3.039</td><td style="text-align: right;">-12.761</td><td style="text-align: right;"> 32.665</td><td style="text-align: right;">-56.601</td><td style="text-align: right;"> 69.631</td><td style="text-align: right;">-61.955</td><td style="text-align: right;"> 39.805</td><td style="text-align: right;">-18.069</td><td style="text-align: right;"> 5.512</td><td style="text-align: right;">-1.016</td><td style="text-align: right;"> 0.086</td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;"> -0.008</td><td style="text-align: right;">  0.021</td><td style="text-align: right;"> -0.028</td><td style="text-align: right;">  0.021</td><td style="text-align: right;"> -0.008</td><td style="text-align: right;">  0.001</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 0.006</td><td style="text-align: right;"> -0.037</td><td style="text-align: right;">  0.108</td><td style="text-align: right;"> -0.174</td><td style="text-align: right;">  0.167</td><td style="text-align: right;"> -0.096</td><td style="text-align: right;">  0.031</td><td style="text-align: right;"> -0.004</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 0.014</td><td style="text-align: right;"> -0.101</td><td style="text-align: right;">  0.332</td><td style="text-align: right;"> -0.621</td><td style="text-align: right;">  0.726</td><td style="text-align: right;"> -0.543</td><td style="text-align: right;">  0.254</td><td style="text-align: right;"> -0.068</td><td style="text-align: right;">  0.008</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 0.026</td><td style="text-align: right;"> -0.214</td><td style="text-align: right;">  0.782</td><td style="text-align: right;"> -1.671</td><td style="text-align: right;">  2.301</td><td style="text-align: right;"> -2.118</td><td style="text-align: right;">  1.304</td><td style="text-align: right;"> -0.518</td><td style="text-align: right;">  0.12 </td><td style="text-align: right;">-0.012</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 0.043</td><td style="text-align: right;"> -0.388</td><td style="text-align: right;">  1.567</td><td style="text-align: right;"> -3.763</td><td style="text-align: right;">  5.962</td><td style="text-align: right;"> -6.512</td><td style="text-align: right;">  4.966</td><td style="text-align: right;"> -2.61 </td><td style="text-align: right;">  0.905</td><td style="text-align: right;">-0.187</td><td style="text-align: right;"> 0.017</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 0.066</td><td style="text-align: right;"> -0.637</td><td style="text-align: right;">  2.809</td><td style="text-align: right;"> -7.492</td><td style="text-align: right;"> 13.42 </td><td style="text-align: right;">-16.952</td><td style="text-align: right;"> 15.406</td><td style="text-align: right;">-10.068</td><td style="text-align: right;">  4.634</td><td style="text-align: right;">-1.43 </td><td style="text-align: right;"> 0.266</td><td style="text-align: right;">-0.023</td><td style="text-align: right;">     </td></tr>
<tr><td style="text-align: right;">           6</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 0.094</td><td style="text-align: right;"> -0.971</td><td style="text-align: right;">  4.647</td><td style="text-align: right;">-13.618</td><td style="text-align: right;"> 27.204</td><td style="text-align: right;">-39.007</td><td style="text-align: right;"> 41.137</td><td style="text-align: right;">-32.123</td><td style="text-align: right;"> 18.418</td><td style="text-align: right;">-7.556</td><td style="text-align: right;"> 2.104</td><td style="text-align: right;">-0.357</td><td style="text-align: right;">0.028</td></tr>
</tbody>
</table>
</div>
<br />
<br /><p>We notice that the sum of the coefficients is zero.</p>
<p>Make a plot of the coefficients depending on the indices.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">maximum_differentiation_order</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">formula_accuracy_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
<span class="n">color_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mcolors</span><span class="o">.</span><span class="n">TABLEAU_COLORS</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">marker_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="s2">&quot;v&quot;</span><span class="p">,</span> <span class="s2">&quot;^&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">]</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Forward finite difference&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">differentiation_order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">maximum_differentiation_order</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">formula_accuracy_list</span><span class="p">)):</span>
        <span class="n">finite_difference</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">GeneralFiniteDifference</span><span class="p">(</span>
            <span class="n">scaled_exp</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">differentiation_order</span><span class="p">,</span> <span class="n">formula_accuracy_list</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">direction</span>
        <span class="p">)</span>
        <span class="n">coefficients</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_coefficients</span><span class="p">()</span>
        <span class="n">imin</span><span class="p">,</span> <span class="n">imax</span> <span class="o">=</span> <span class="n">finite_difference</span><span class="o">.</span><span class="n">get_indices_min_max</span><span class="p">()</span>
        <span class="n">this_label</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;$d = &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">differentiation_order</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">r</span><span class="s2">&quot;$, $p = &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formula_accuracy_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="sa">r</span><span class="s2">&quot;$&quot;</span>
        <span class="p">)</span>
        <span class="n">this_color</span> <span class="o">=</span> <span class="n">color_list</span><span class="p">[</span><span class="n">differentiation_order</span><span class="p">]</span>
        <span class="n">this_marker</span> <span class="o">=</span> <span class="n">marker_list</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="nb">range</span><span class="p">(</span><span class="n">imin</span><span class="p">,</span> <span class="n">imax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">coefficients</span><span class="p">,</span>
            <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">this_marker</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">this_color</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">this_label</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$i$&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$c_i$&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_general_fd_002.png" srcset="../_images/sphx_glr_plot_general_fd_002.png" alt="Forward finite difference" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.403 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-example-plot-general-fd-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/808bad069f5e429c722c408034c85ece/plot_general_fd.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_general_fd.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/617ac361d082e884ca4957e871d87a67/plot_general_fd.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_general_fd.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d80d81dd9d45314c269e1a519630df2c/plot_general_fd.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_general_fd.zip</span></code></a></p>
</div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">numericalderivative</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/user_manual.html">User manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../examples/examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_numericalderivative.html">A simple demonstration of the methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_openturns.html">Applies Stepleman &amp; Winarsky method to an OpenTURNS function</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_use_benchmark.html">Use the benchmark problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_finite_differences.html">Use the finite differences formulas</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Use the generalized finite differences formulas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-the-first-derivative-using-forward-f-d-formula">Compute the first derivative using forward F.D. formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-the-exact-step-for-the-forward-f-d-formula">Compute the exact step for the forward F.D. formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-the-coefficients-of-several-central-f-d-formulas">Compute the coefficients of several central F.D. formulas</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compute-the-coefficients-of-several-forward-f-d-formulas">Compute the coefficients of several forward F.D. formulas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_general_fd_convergence.html">Convergence of the generalized finite differences formulas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#dumontet-vignes">Dumontet &amp; Vignes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#gill-murray-saunders-wright">Gill, Murray, Saunders &amp; Wright</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#stepleman-winarsky">Stepleman &amp; Winarsky</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/examples.html#shi-xie-xuan-nocedal">Shi, Xie, Xuan &amp; Nocedal</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../examples/examples.html">Examples</a><ul>
      <li>Previous: <a href="plot_finite_differences.html" title="previous chapter">Use the finite differences formulas</a></li>
      <li>Next: <a href="plot_general_fd_convergence.html" title="next chapter">Convergence of the generalized finite differences formulas</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;M. Baudin.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/auto_example/plot_general_fd.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>