
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_example/plot_general_fd.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_example_plot_general_fd.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_example_plot_general_fd.py:


Use the generalized finite differences formulas
===============================================

This example shows how to use generalized finite difference (F.D.) formulas.

References
----------
- M. Baudin (2023). Méthodes numériques. Dunod.

.. GENERATED FROM PYTHON SOURCE LINES 16-22

.. code-block:: Python

    import numericalderivative as nd
    import numpy as np
    import pylab as pl
    import matplotlib.colors as mcolors
    import tabulate








.. GENERATED FROM PYTHON SOURCE LINES 23-25

Compute the first derivative using forward F.D. formula
-------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 28-29

This is the function we want to compute the derivative of.

.. GENERATED FROM PYTHON SOURCE LINES 29-34

.. code-block:: Python

    def scaled_exp(x):
        alpha = 1.0e6
        return np.exp(-x / alpha)









.. GENERATED FROM PYTHON SOURCE LINES 35-36

Use the F.D. formula for f'(x)

.. GENERATED FROM PYTHON SOURCE LINES 36-46

.. code-block:: Python

    x = 1.0
    differentiation_order = 1
    formula_accuracy = 2
    finite_difference = nd.GeneralFiniteDifference(
        scaled_exp, x, differentiation_order, formula_accuracy, "central"
    )
    step = 1.0e-3  # A first guess
    f_prime_approx = finite_difference.compute(step)
    print(f"Approximate f'(x) = {f_prime_approx}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Approximate f'(x) = -9.999989725173464e-07




.. GENERATED FROM PYTHON SOURCE LINES 47-48

To check our result, we define the exact first derivative.

.. GENERATED FROM PYTHON SOURCE LINES 51-56

.. code-block:: Python

    def scaled_exp_prime(x):
        alpha = 1.0e6
        return -np.exp(-x / alpha) / alpha









.. GENERATED FROM PYTHON SOURCE LINES 57-58

Compute the exact derivative and the absolute error.

.. GENERATED FROM PYTHON SOURCE LINES 58-63

.. code-block:: Python

    f_prime_exact = scaled_exp_prime(x)
    print(f"Exact f'(x) = {f_prime_exact}")
    absolute_error = abs(f_prime_approx - f_prime_exact)
    print(f"Absolute error = {absolute_error}")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Exact f'(x) = -9.999990000005e-07
    Absolute error = 2.7483153726165933e-14




.. GENERATED FROM PYTHON SOURCE LINES 64-65

Define the error function: this will be useful later.

.. GENERATED FROM PYTHON SOURCE LINES 68-89

.. code-block:: Python

    def compute_absolute_error(
        step,
        x=1.0,
        differentiation_order=1,
        formula_accuracy=2,
        direction="central",
        verbose=True,
    ):
        finite_difference = nd.GeneralFiniteDifference(
            scaled_exp, x, differentiation_order, formula_accuracy, direction
        )
        f_prime_approx = finite_difference.compute(step)
        f_prime_exact = scaled_exp_prime(x)
        absolute_error = abs(f_prime_approx - f_prime_exact)
        if verbose:
            print(f"Approximate f'(x) = {f_prime_approx}")
            print(f"Exact f'(x) = {f_prime_exact}")
            print(f"Absolute error = {absolute_error}")
        return absolute_error









.. GENERATED FROM PYTHON SOURCE LINES 90-92

Compute the exact step for the forward F.D. formula
---------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 94-97

This step depends on the second derivative.
Firstly, we assume that this is unknown and use a first
guess of it, equal to 1.

.. GENERATED FROM PYTHON SOURCE LINES 99-111

.. code-block:: Python

    differentiation_order = 1
    formula_accuracy = 2
    direction = "central"
    finite_difference = nd.GeneralFiniteDifference(
        scaled_exp, x, differentiation_order, formula_accuracy, direction
    )
    second_derivative_value = 1.0  # A first guess
    step, absolute_error = finite_difference.compute_step(second_derivative_value)
    print(f"Approximately optimal step (using f''(x) = 1) = {step}")
    print(f"Approximately absolute error = {absolute_error}")
    _ = compute_absolute_error(step, True)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Approximately optimal step (using f''(x) = 1) = 8.733476581980381e-06
    Approximately absolute error = 3.8136806603999814e-11
    Approximate f'(x) = -9.999979182323467e-07
    Exact f'(x) = -9.999990000005e-07
    Absolute error = 1.081768153431351e-12




.. GENERATED FROM PYTHON SOURCE LINES 112-115

We see that the new step is much better than the our initial guess:
the approximately optimal step is much smaller, which leads to a smaller
absolute error.

.. GENERATED FROM PYTHON SOURCE LINES 117-119

In our particular example, the second derivative is known: let's use
this information and compute the exactly optimal step.

.. GENERATED FROM PYTHON SOURCE LINES 122-127

.. code-block:: Python

    def scaled_exp_2nd_derivative(x):
        alpha = 1.0e6
        return np.exp(-x / alpha) / (alpha**2)









.. GENERATED FROM PYTHON SOURCE LINES 128-135

.. code-block:: Python

    second_derivative_value = scaled_exp_2nd_derivative(x)
    print(f"Exact second derivative f''(x) = {second_derivative_value}")
    step, absolute_error = finite_difference.compute_step(second_derivative_value)
    print(f"Approximately optimal step (using f''(x) = 1) = {step}")
    print(f"Approximately absolute error = {absolute_error}")
    _ = compute_absolute_error(step, True)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Exact second derivative f''(x) = 9.999990000005e-13
    Approximately optimal step (using f''(x) = 1) = 0.08733479493139723
    Approximately absolute error = 3.813679389173307e-15
    Approximate f'(x) = -9.999989997748166e-07
    Exact f'(x) = -9.999990000005e-07
    Absolute error = 2.256834584664358e-16




.. GENERATED FROM PYTHON SOURCE LINES 136-138

Compute the coefficients of several central F.D. formulas
=========================================================

.. GENERATED FROM PYTHON SOURCE LINES 140-142

We would like to compute the coefficients of a collection of central
finite difference formulas.

.. GENERATED FROM PYTHON SOURCE LINES 144-146

We consider the differentation order up to the sixth derivative
and the central F.D. formula up to the order 8.

.. GENERATED FROM PYTHON SOURCE LINES 146-149

.. code-block:: Python

    maximum_differentiation_order = 6
    formula_accuracy_list = [2, 4, 6, 8]








.. GENERATED FROM PYTHON SOURCE LINES 150-153

We want to the print the result as a table.
This is the reason why we need to align the coefficients on the
columns on the table.

.. GENERATED FROM PYTHON SOURCE LINES 155-156

First pass: compute the maximum number of coefficients.

.. GENERATED FROM PYTHON SOURCE LINES 156-170

.. code-block:: Python

    maximum_number_of_coefficients = 0
    direction = "central"
    coefficients_list = []
    for differentiation_order in range(1, 1 + maximum_differentiation_order):
        for formula_accuracy in formula_accuracy_list:
            finite_difference = nd.GeneralFiniteDifference(
                scaled_exp, x, differentiation_order, formula_accuracy, direction
            )
            coefficients = finite_difference.get_coefficients()
            coefficients_list.append(coefficients)
            maximum_number_of_coefficients = max(
                maximum_number_of_coefficients, len(coefficients)
            )








.. GENERATED FROM PYTHON SOURCE LINES 171-172

Second pass: compute the maximum number of coefficients

.. GENERATED FROM PYTHON SOURCE LINES 172-186

.. code-block:: Python

    data = []
    index = 0
    for differentiation_order in range(1, 1 + maximum_differentiation_order):
        for formula_accuracy in formula_accuracy_list:
            coefficients = coefficients_list[index]
            row = [differentiation_order, formula_accuracy]
            padding_number = maximum_number_of_coefficients // 2 - len(coefficients) // 2
            for i in range(padding_number):
                row.append("")
            for i in range(len(coefficients)):
                row.append(f"{coefficients[i]:.3f}")
            data.append(row)
            index += 1








.. GENERATED FROM PYTHON SOURCE LINES 187-192

.. code-block:: Python

    headers = ["Derivative", "Accuracy"]
    for i in range(1 + maximum_number_of_coefficients):
        headers.append(i - maximum_number_of_coefficients // 2)
    tabulate.tabulate(data, headers, tablefmt="html")






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table>
    <thead>
    <tr><th style="text-align: right;">  Derivative</th><th style="text-align: right;">  Accuracy</th><th>-6    </th><th>-5    </th><th>-4    </th><th>-3    </th><th>-2    </th><th style="text-align: right;">    -1</th><th style="text-align: right;">     0</th><th style="text-align: right;">     1</th><th style="text-align: right;">     2</th><th style="text-align: right;">     3</th><th style="text-align: right;">     4</th><th style="text-align: right;">     5</th><th style="text-align: right;">  6</th></tr>
    </thead>
    <tbody>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>      </td><td style="text-align: right;">-0.5  </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>      </td><td>0.083 </td><td style="text-align: right;">-0.667</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-0.083</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>      </td><td>-0.017</td><td>0.150 </td><td style="text-align: right;">-0.75 </td><td style="text-align: right;">-0    </td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-0.15 </td><td style="text-align: right;"> 0.017</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         8</td><td>      </td><td>      </td><td>0.004 </td><td>-0.038</td><td>0.200 </td><td style="text-align: right;">-0.8  </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-0.2  </td><td style="text-align: right;"> 0.038</td><td style="text-align: right;">-0.004</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>      </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">-1    </td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>      </td><td>-0.042</td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-1.25 </td><td style="text-align: right;"> 0.667</td><td style="text-align: right;">-0.042</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>      </td><td>0.006 </td><td>-0.075</td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-1.361</td><td style="text-align: right;"> 0.75 </td><td style="text-align: right;">-0.075</td><td style="text-align: right;"> 0.006</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         8</td><td>      </td><td>      </td><td>-0.001</td><td>0.013 </td><td>-0.100</td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-1.424</td><td style="text-align: right;"> 0.8  </td><td style="text-align: right;">-0.1  </td><td style="text-align: right;"> 0.013</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>-0.083</td><td style="text-align: right;"> 0.167</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.083</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>0.021 </td><td>-0.167</td><td style="text-align: right;"> 0.271</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.167</td><td style="text-align: right;">-0.021</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>-0.005</td><td>0.050 </td><td>-0.235</td><td style="text-align: right;"> 0.339</td><td style="text-align: right;">-0    </td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.235</td><td style="text-align: right;">-0.05 </td><td style="text-align: right;"> 0.005</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         8</td><td>      </td><td>0.001 </td><td>-0.014</td><td>0.081 </td><td>-0.289</td><td style="text-align: right;"> 0.386</td><td style="text-align: right;">-0    </td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.289</td><td style="text-align: right;">-0.081</td><td style="text-align: right;"> 0.014</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>      </td><td>0.042 </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.25 </td><td style="text-align: right;">-0.167</td><td style="text-align: right;"> 0.042</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>      </td><td>-0.007</td><td>0.083 </td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.389</td><td style="text-align: right;">-0.271</td><td style="text-align: right;"> 0.083</td><td style="text-align: right;">-0.007</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         6</td><td>      </td><td>      </td><td>0.001 </td><td>-0.017</td><td>0.117 </td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.474</td><td style="text-align: right;">-0.339</td><td style="text-align: right;"> 0.117</td><td style="text-align: right;">-0.017</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         8</td><td>      </td><td>-0.000</td><td>0.003 </td><td>-0.027</td><td>0.144 </td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.531</td><td style="text-align: right;">-0.386</td><td style="text-align: right;"> 0.144</td><td style="text-align: right;">-0.027</td><td style="text-align: right;"> 0.003</td><td style="text-align: right;">-0    </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>-0.004</td><td>0.017 </td><td style="text-align: right;">-0.021</td><td style="text-align: right;">-0    </td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.017</td><td style="text-align: right;"> 0.004</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>0.001 </td><td>-0.013</td><td>0.036 </td><td style="text-align: right;">-0.04 </td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.036</td><td style="text-align: right;"> 0.012</td><td style="text-align: right;">-0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         6</td><td>      </td><td>-0.000</td><td>0.004 </td><td>-0.023</td><td>0.054 </td><td style="text-align: right;">-0.056</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.054</td><td style="text-align: right;"> 0.023</td><td style="text-align: right;">-0.004</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         8</td><td>0.000 </td><td>-0.001</td><td>0.009 </td><td>-0.033</td><td>0.070 </td><td style="text-align: right;">-0.069</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.07 </td><td style="text-align: right;"> 0.033</td><td style="text-align: right;">-0.009</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;"> -0</td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         2</td><td>      </td><td>      </td><td>      </td><td>0.001 </td><td>-0.008</td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.028</td><td style="text-align: right;"> 0.021</td><td style="text-align: right;">-0.008</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         4</td><td>      </td><td>      </td><td>-0.000</td><td>0.004 </td><td>-0.018</td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.052</td><td style="text-align: right;"> 0.04 </td><td style="text-align: right;">-0.018</td><td style="text-align: right;"> 0.004</td><td style="text-align: right;">-0    </td><td style="text-align: right;">      </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         6</td><td>      </td><td>0.000 </td><td>-0.001</td><td>0.008 </td><td>-0.027</td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.071</td><td style="text-align: right;"> 0.056</td><td style="text-align: right;">-0.027</td><td style="text-align: right;"> 0.008</td><td style="text-align: right;">-0.001</td><td style="text-align: right;"> 0    </td><td style="text-align: right;">   </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         8</td><td>-0.000</td><td>0.000 </td><td>-0.002</td><td>0.011 </td><td>-0.035</td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.086</td><td style="text-align: right;"> 0.069</td><td style="text-align: right;">-0.035</td><td style="text-align: right;"> 0.011</td><td style="text-align: right;">-0.002</td><td style="text-align: right;"> 0    </td><td style="text-align: right;"> -0</td></tr>
    </tbody>
    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 193-202

We notice that the sum of the coefficients is zero.
Furthermore, consider the properties of the coefficients with respect to the
center coefficient of index :math:`i = 0`.

- If the differentiation order :math:`d` is odd (e.g. :math:`d = 3`),
  then the symetrical coefficients are of opposite signs.
  In this case, :math:`c_0 = 0`.
- If the differentiation order :math:`d` is even (e.g. :math:`d = 4`),
  then the symetrical coefficients are equal.

.. GENERATED FROM PYTHON SOURCE LINES 204-205

Make a plot of the coefficients depending on the indices.

.. GENERATED FROM PYTHON SOURCE LINES 205-240

.. code-block:: Python

    maximum_differentiation_order = 4
    formula_accuracy_list = [2, 4, 6]
    direction = "central"
    color_list = list(mcolors.TABLEAU_COLORS.keys())
    marker_list = ["o", "v", "^", "<", ">"]
    pl.figure()
    pl.title("Central finite difference")
    for differentiation_order in range(1, 1 + maximum_differentiation_order):
        for j in range(len(formula_accuracy_list)):
            finite_difference = nd.GeneralFiniteDifference(
                scaled_exp, x, differentiation_order, formula_accuracy_list[j], direction
            )
            coefficients = finite_difference.get_coefficients()
            imin, imax = finite_difference.get_indices_min_max()
            this_label = (
                r"$d = "
                f"{differentiation_order}"
                r"$, $p = "
                f"{formula_accuracy_list[j]}"
                r"$"
            )
            this_color = color_list[differentiation_order]
            this_marker = marker_list[j]
            pl.plot(
                range(imin, imax + 1),
                coefficients,
                "-" + this_marker,
                color=this_color,
                label=this_label,
            )
    pl.xlabel(r"$i$")
    pl.ylabel(r"$c_i$")
    pl.legend(bbox_to_anchor=(1, 1))
    pl.tight_layout()




.. image-sg:: /auto_example/images/sphx_glr_plot_general_fd_001.png
   :alt: Central finite difference
   :srcset: /auto_example/images/sphx_glr_plot_general_fd_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 241-243

Compute the coefficients of several forward F.D. formulas
=========================================================

.. GENERATED FROM PYTHON SOURCE LINES 245-247

We would like to compute the coefficients of a collection of forward
finite difference formulas.

.. GENERATED FROM PYTHON SOURCE LINES 249-251

We consider the differentation order up to the sixth derivative
and the forward F.D. formula up to the order 8.

.. GENERATED FROM PYTHON SOURCE LINES 251-254

.. code-block:: Python

    maximum_differentiation_order = 6
    formula_accuracy_list = list(range(1, 8))








.. GENERATED FROM PYTHON SOURCE LINES 255-258

We want to the print the result as a table.
This is the reason why we need to align the coefficients on the
columns on the table.

.. GENERATED FROM PYTHON SOURCE LINES 260-261

First pass: compute the maximum number of coefficients.

.. GENERATED FROM PYTHON SOURCE LINES 261-279

.. code-block:: Python

    maximum_number_of_coefficients = 0
    direction = "forward"
    data = []
    for differentiation_order in range(1, 1 + maximum_differentiation_order):
        for formula_accuracy in formula_accuracy_list:
            finite_difference = nd.GeneralFiniteDifference(
                scaled_exp, x, differentiation_order, formula_accuracy, direction
            )
            coefficients = finite_difference.get_coefficients()
            maximum_number_of_coefficients = max(
                maximum_number_of_coefficients, len(coefficients)
            )
            row = [differentiation_order, formula_accuracy]
            for i in range(len(coefficients)):
                row.append(f"{coefficients[i]:.3f}")
            data.append(row)
            index += 1








.. GENERATED FROM PYTHON SOURCE LINES 280-285

.. code-block:: Python

    headers = ["Derivative", "Accuracy"]
    for i in range(1 + maximum_number_of_coefficients):
        headers.append(i)
    tabulate.tabulate(data, headers, tablefmt="html")






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table>
    <thead>
    <tr><th style="text-align: right;">  Derivative</th><th style="text-align: right;">  Accuracy</th><th style="text-align: right;">     0</th><th style="text-align: right;">      1</th><th style="text-align: right;">      2</th><th style="text-align: right;">      3</th><th style="text-align: right;">      4</th><th style="text-align: right;">      5</th><th style="text-align: right;">      6</th><th style="text-align: right;">      7</th><th style="text-align: right;">      8</th><th style="text-align: right;">     9</th><th style="text-align: right;">    10</th><th style="text-align: right;">    11</th><th style="text-align: right;">   12</th></tr>
    </thead>
    <tbody>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         1</td><td style="text-align: right;">-1    </td><td style="text-align: right;">  1    </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         2</td><td style="text-align: right;">-1.5  </td><td style="text-align: right;">  2    </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         3</td><td style="text-align: right;">-1.833</td><td style="text-align: right;">  3    </td><td style="text-align: right;"> -1.5  </td><td style="text-align: right;">  0.333</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         4</td><td style="text-align: right;">-2.083</td><td style="text-align: right;">  4    </td><td style="text-align: right;"> -3    </td><td style="text-align: right;">  1.333</td><td style="text-align: right;"> -0.25 </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         5</td><td style="text-align: right;">-2.283</td><td style="text-align: right;">  5    </td><td style="text-align: right;"> -5    </td><td style="text-align: right;">  3.333</td><td style="text-align: right;"> -1.25 </td><td style="text-align: right;">  0.2  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         6</td><td style="text-align: right;">-2.45 </td><td style="text-align: right;">  6    </td><td style="text-align: right;"> -7.5  </td><td style="text-align: right;">  6.667</td><td style="text-align: right;"> -3.75 </td><td style="text-align: right;">  1.2  </td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           1</td><td style="text-align: right;">         7</td><td style="text-align: right;">-2.593</td><td style="text-align: right;">  7    </td><td style="text-align: right;">-10.5  </td><td style="text-align: right;"> 11.667</td><td style="text-align: right;"> -8.75 </td><td style="text-align: right;">  4.2  </td><td style="text-align: right;"> -1.167</td><td style="text-align: right;">  0.143</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.5  </td><td style="text-align: right;"> -1    </td><td style="text-align: right;">  0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 1    </td><td style="text-align: right;"> -2.5  </td><td style="text-align: right;">  2    </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 1.458</td><td style="text-align: right;"> -4.333</td><td style="text-align: right;">  4.75 </td><td style="text-align: right;"> -2.333</td><td style="text-align: right;">  0.458</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 1.875</td><td style="text-align: right;"> -6.417</td><td style="text-align: right;">  8.917</td><td style="text-align: right;"> -6.5  </td><td style="text-align: right;">  2.542</td><td style="text-align: right;"> -0.417</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 2.256</td><td style="text-align: right;"> -8.7  </td><td style="text-align: right;"> 14.625</td><td style="text-align: right;">-14.111</td><td style="text-align: right;">  8.25 </td><td style="text-align: right;"> -2.7  </td><td style="text-align: right;">  0.381</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 2.606</td><td style="text-align: right;">-11.15 </td><td style="text-align: right;"> 21.975</td><td style="text-align: right;">-26.361</td><td style="text-align: right;"> 20.5  </td><td style="text-align: right;">-10.05 </td><td style="text-align: right;">  2.831</td><td style="text-align: right;"> -0.35 </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           2</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 2.93 </td><td style="text-align: right;">-13.743</td><td style="text-align: right;"> 31.05 </td><td style="text-align: right;">-44.511</td><td style="text-align: right;"> 43.188</td><td style="text-align: right;">-28.2  </td><td style="text-align: right;"> 11.906</td><td style="text-align: right;"> -2.943</td><td style="text-align: right;">  0.324</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         1</td><td style="text-align: right;">-0.167</td><td style="text-align: right;">  0.5  </td><td style="text-align: right;"> -0.5  </td><td style="text-align: right;">  0.167</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         2</td><td style="text-align: right;">-0.417</td><td style="text-align: right;">  1.5  </td><td style="text-align: right;"> -2    </td><td style="text-align: right;">  1.167</td><td style="text-align: right;"> -0.25 </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         3</td><td style="text-align: right;">-0.708</td><td style="text-align: right;">  2.958</td><td style="text-align: right;"> -4.917</td><td style="text-align: right;">  4.083</td><td style="text-align: right;"> -1.708</td><td style="text-align: right;">  0.292</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         4</td><td style="text-align: right;">-1.021</td><td style="text-align: right;">  4.833</td><td style="text-align: right;"> -9.604</td><td style="text-align: right;"> 10.333</td><td style="text-align: right;"> -6.396</td><td style="text-align: right;">  2.167</td><td style="text-align: right;"> -0.312</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         5</td><td style="text-align: right;">-1.343</td><td style="text-align: right;">  7.089</td><td style="text-align: right;">-16.371</td><td style="text-align: right;"> 21.611</td><td style="text-align: right;">-17.674</td><td style="text-align: right;">  8.933</td><td style="text-align: right;"> -2.568</td><td style="text-align: right;">  0.322</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         6</td><td style="text-align: right;">-1.669</td><td style="text-align: right;">  9.694</td><td style="text-align: right;">-25.49 </td><td style="text-align: right;"> 39.85 </td><td style="text-align: right;">-40.472</td><td style="text-align: right;"> 27.172</td><td style="text-align: right;">-11.688</td><td style="text-align: right;">  2.928</td><td style="text-align: right;"> -0.326</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           3</td><td style="text-align: right;">         7</td><td style="text-align: right;">-1.994</td><td style="text-align: right;"> 12.624</td><td style="text-align: right;">-37.209</td><td style="text-align: right;"> 67.194</td><td style="text-align: right;">-81.487</td><td style="text-align: right;"> 68.187</td><td style="text-align: right;">-39.031</td><td style="text-align: right;"> 14.646</td><td style="text-align: right;"> -3.255</td><td style="text-align: right;"> 0.326</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.042</td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">  0.25 </td><td style="text-align: right;"> -0.167</td><td style="text-align: right;">  0.042</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 0.125</td><td style="text-align: right;"> -0.583</td><td style="text-align: right;">  1.083</td><td style="text-align: right;"> -1    </td><td style="text-align: right;">  0.458</td><td style="text-align: right;"> -0.083</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 0.243</td><td style="text-align: right;"> -1.292</td><td style="text-align: right;">  2.854</td><td style="text-align: right;"> -3.361</td><td style="text-align: right;">  2.229</td><td style="text-align: right;"> -0.792</td><td style="text-align: right;">  0.118</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 0.389</td><td style="text-align: right;"> -2.312</td><td style="text-align: right;">  5.917</td><td style="text-align: right;"> -8.465</td><td style="text-align: right;">  7.333</td><td style="text-align: right;"> -3.854</td><td style="text-align: right;">  1.139</td><td style="text-align: right;"> -0.146</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 0.557</td><td style="text-align: right;"> -3.656</td><td style="text-align: right;"> 10.617</td><td style="text-align: right;">-17.867</td><td style="text-align: right;"> 19.085</td><td style="text-align: right;">-13.256</td><td style="text-align: right;">  5.84 </td><td style="text-align: right;"> -1.489</td><td style="text-align: right;">  0.168</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 0.742</td><td style="text-align: right;"> -5.324</td><td style="text-align: right;"> 17.292</td><td style="text-align: right;">-33.442</td><td style="text-align: right;"> 42.448</td><td style="text-align: right;">-36.618</td><td style="text-align: right;"> 21.415</td><td style="text-align: right;"> -8.164</td><td style="text-align: right;">  1.837</td><td style="text-align: right;">-0.185</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           4</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 0.942</td><td style="text-align: right;"> -7.319</td><td style="text-align: right;"> 26.267</td><td style="text-align: right;">-57.373</td><td style="text-align: right;"> 84.327</td><td style="text-align: right;">-86.874</td><td style="text-align: right;"> 63.294</td><td style="text-align: right;">-32.095</td><td style="text-align: right;"> 10.811</td><td style="text-align: right;">-2.18 </td><td style="text-align: right;"> 0.199</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         1</td><td style="text-align: right;">-0.008</td><td style="text-align: right;">  0.042</td><td style="text-align: right;"> -0.083</td><td style="text-align: right;">  0.083</td><td style="text-align: right;"> -0.042</td><td style="text-align: right;">  0.008</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         2</td><td style="text-align: right;">-0.029</td><td style="text-align: right;">  0.167</td><td style="text-align: right;"> -0.396</td><td style="text-align: right;">  0.5  </td><td style="text-align: right;"> -0.354</td><td style="text-align: right;">  0.133</td><td style="text-align: right;"> -0.021</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         3</td><td style="text-align: right;">-0.064</td><td style="text-align: right;">  0.41 </td><td style="text-align: right;"> -1.125</td><td style="text-align: right;">  1.715</td><td style="text-align: right;"> -1.569</td><td style="text-align: right;">  0.862</td><td style="text-align: right;"> -0.264</td><td style="text-align: right;">  0.035</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         4</td><td style="text-align: right;">-0.113</td><td style="text-align: right;">  0.799</td><td style="text-align: right;"> -2.486</td><td style="text-align: right;">  4.438</td><td style="text-align: right;"> -4.972</td><td style="text-align: right;">  3.585</td><td style="text-align: right;"> -1.625</td><td style="text-align: right;">  0.424</td><td style="text-align: right;"> -0.049</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         5</td><td style="text-align: right;">-0.174</td><td style="text-align: right;">  1.355</td><td style="text-align: right;"> -4.713</td><td style="text-align: right;">  9.634</td><td style="text-align: right;">-12.767</td><td style="text-align: right;"> 11.38 </td><td style="text-align: right;"> -6.822</td><td style="text-align: right;">  2.651</td><td style="text-align: right;"> -0.605</td><td style="text-align: right;"> 0.062</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         6</td><td style="text-align: right;">-0.249</td><td style="text-align: right;">  2.098</td><td style="text-align: right;"> -8.053</td><td style="text-align: right;"> 18.54 </td><td style="text-align: right;">-28.353</td><td style="text-align: right;"> 30.083</td><td style="text-align: right;">-22.407</td><td style="text-align: right;"> 11.557</td><td style="text-align: right;"> -3.945</td><td style="text-align: right;"> 0.804</td><td style="text-align: right;">-0.074</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           5</td><td style="text-align: right;">         7</td><td style="text-align: right;">-0.334</td><td style="text-align: right;">  3.039</td><td style="text-align: right;">-12.761</td><td style="text-align: right;"> 32.665</td><td style="text-align: right;">-56.601</td><td style="text-align: right;"> 69.631</td><td style="text-align: right;">-61.955</td><td style="text-align: right;"> 39.805</td><td style="text-align: right;">-18.069</td><td style="text-align: right;"> 5.512</td><td style="text-align: right;">-1.016</td><td style="text-align: right;"> 0.086</td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         1</td><td style="text-align: right;"> 0.001</td><td style="text-align: right;"> -0.008</td><td style="text-align: right;">  0.021</td><td style="text-align: right;"> -0.028</td><td style="text-align: right;">  0.021</td><td style="text-align: right;"> -0.008</td><td style="text-align: right;">  0.001</td><td style="text-align: right;">       </td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         2</td><td style="text-align: right;"> 0.006</td><td style="text-align: right;"> -0.037</td><td style="text-align: right;">  0.108</td><td style="text-align: right;"> -0.174</td><td style="text-align: right;">  0.167</td><td style="text-align: right;"> -0.096</td><td style="text-align: right;">  0.031</td><td style="text-align: right;"> -0.004</td><td style="text-align: right;">       </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         3</td><td style="text-align: right;"> 0.014</td><td style="text-align: right;"> -0.101</td><td style="text-align: right;">  0.332</td><td style="text-align: right;"> -0.621</td><td style="text-align: right;">  0.726</td><td style="text-align: right;"> -0.543</td><td style="text-align: right;">  0.254</td><td style="text-align: right;"> -0.068</td><td style="text-align: right;">  0.008</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         4</td><td style="text-align: right;"> 0.026</td><td style="text-align: right;"> -0.214</td><td style="text-align: right;">  0.782</td><td style="text-align: right;"> -1.671</td><td style="text-align: right;">  2.301</td><td style="text-align: right;"> -2.118</td><td style="text-align: right;">  1.304</td><td style="text-align: right;"> -0.518</td><td style="text-align: right;">  0.12 </td><td style="text-align: right;">-0.012</td><td style="text-align: right;">      </td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         5</td><td style="text-align: right;"> 0.043</td><td style="text-align: right;"> -0.388</td><td style="text-align: right;">  1.567</td><td style="text-align: right;"> -3.763</td><td style="text-align: right;">  5.962</td><td style="text-align: right;"> -6.512</td><td style="text-align: right;">  4.966</td><td style="text-align: right;"> -2.61 </td><td style="text-align: right;">  0.905</td><td style="text-align: right;">-0.187</td><td style="text-align: right;"> 0.017</td><td style="text-align: right;">      </td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         6</td><td style="text-align: right;"> 0.066</td><td style="text-align: right;"> -0.637</td><td style="text-align: right;">  2.809</td><td style="text-align: right;"> -7.492</td><td style="text-align: right;"> 13.42 </td><td style="text-align: right;">-16.952</td><td style="text-align: right;"> 15.406</td><td style="text-align: right;">-10.068</td><td style="text-align: right;">  4.634</td><td style="text-align: right;">-1.43 </td><td style="text-align: right;"> 0.266</td><td style="text-align: right;">-0.023</td><td style="text-align: right;">     </td></tr>
    <tr><td style="text-align: right;">           6</td><td style="text-align: right;">         7</td><td style="text-align: right;"> 0.094</td><td style="text-align: right;"> -0.971</td><td style="text-align: right;">  4.647</td><td style="text-align: right;">-13.618</td><td style="text-align: right;"> 27.204</td><td style="text-align: right;">-39.007</td><td style="text-align: right;"> 41.137</td><td style="text-align: right;">-32.123</td><td style="text-align: right;"> 18.418</td><td style="text-align: right;">-7.556</td><td style="text-align: right;"> 2.104</td><td style="text-align: right;">-0.357</td><td style="text-align: right;">0.028</td></tr>
    </tbody>
    </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 286-287

We notice that the sum of the coefficients is zero.

.. GENERATED FROM PYTHON SOURCE LINES 289-290

Make a plot of the coefficients depending on the indices.

.. GENERATED FROM PYTHON SOURCE LINES 290-325

.. code-block:: Python

    maximum_differentiation_order = 4
    formula_accuracy_list = [2, 4, 6]
    direction = "forward"
    color_list = list(mcolors.TABLEAU_COLORS.keys())
    marker_list = ["o", "v", "^", "<", ">"]
    pl.figure()
    pl.title("Forward finite difference")
    for differentiation_order in range(1, 1 + maximum_differentiation_order):
        for j in range(len(formula_accuracy_list)):
            finite_difference = nd.GeneralFiniteDifference(
                scaled_exp, x, differentiation_order, formula_accuracy_list[j], direction
            )
            coefficients = finite_difference.get_coefficients()
            imin, imax = finite_difference.get_indices_min_max()
            this_label = (
                r"$d = "
                f"{differentiation_order}"
                r"$, $p = "
                f"{formula_accuracy_list[j]}"
                r"$"
            )
            this_color = color_list[differentiation_order]
            this_marker = marker_list[j]
            pl.plot(
                range(imin, imax + 1),
                coefficients,
                "-" + this_marker,
                color=this_color,
                label=this_label,
            )
    pl.xlabel(r"$i$")
    pl.ylabel(r"$c_i$")
    _ = pl.legend(bbox_to_anchor=(1, 1))
    pl.tight_layout()




.. image-sg:: /auto_example/images/sphx_glr_plot_general_fd_002.png
   :alt: Forward finite difference
   :srcset: /auto_example/images/sphx_glr_plot_general_fd_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.372 seconds)


.. _sphx_glr_download_auto_example_plot_general_fd.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_general_fd.ipynb <plot_general_fd.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_general_fd.py <plot_general_fd.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_general_fd.zip <plot_general_fd.zip>`
